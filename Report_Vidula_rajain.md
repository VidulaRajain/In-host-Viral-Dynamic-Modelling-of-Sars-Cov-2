

A Project Report

On

**In-host viral dynamic modeling of**

**SARS-CoV-2 infection**

BY

**VIDULA RAJAIN**

1





**ABSTRACT**

In this paper, we investigate mathematical models to understand the behaviour of SARS-Cov-2

infection in human host and validate the models using reported viral load data. It is a type of

coronavirus that causes respiratory illness. It was first detected in Wuhan, China and is now a global

pandemic. It is dangerous for some people since it can cause severe lung damage, though most people

are asymptomatic.

The virus is transmitted through respiratory droplets, it then settles in the nasal passages and starts

replicating throughout the body. If the virus enters the lungs, it can invade the tiny air sacs (alveoli)

and cause inflammation in the lungs which can cause breathing problems. It has been observed that

initially the viral load increases rapidly till it reaches a peak, followed by a plateau phase possibly

generated by lymphocytes as a secondary target of infection. In the last stage, viral load declines due to

the emergence of adaptive immune responses.

Using viral load data obtained from a paper reporting the clinical trials conducted in Germany, we

would do curve fitting to obtain the value of the unknown parameters used in the mathematical model.

We would then see the effect of treatment on the viral dynamics and compare the effect of drugs with

different efficacies.

2





**Contents**

**ACKNOWLEDGMENTS** ................................................................................**Error! Bookmark not defined.**

**Certificate** ..........................................................................................................**Error! Bookmark not defined.**

[**ABSTRACT**](#br2)[**......................................................................................................................................................2](#br2)

[**INTRODUCTION**](#br4)[**............................................................................................................................................4](#br4)

[**MATHEMATICAL**](#br5)[** ](#br5)[MODELS**](#br5)[**.......................................................................................................................5](#br5)

[A](#br5)[ ](#br5)[BASIC](#br5)[ ](#br5)[VIRAL](#br5)[ ](#br5)[DYNAMIC](#br5)[ ](#br5)[MODEL:](#br5)[ ](#br5)[-................................................................................................................5](#br5)

[**Introduction**](#br5)[**..............................................................................................................................................5](#br5)

[**Data**](#br5)[** ](#br5)[used**](#br5)[** ](#br5)[for**](#br5)[** ](#br5)[this**](#br5)[** ](#br5)[Model:**](#br5)[** ](#br5)[-**](#br5)[**......................................................................................................................5](#br5)

[**Using**](#br6)[** ](#br6)[ode45**](#br6)[** ](#br6)[in**](#br6)[** ](#br6)[MATLAB**](#br6)[** ](#br6)[to**](#br6)[** ](#br6)[solve**](#br6)[** ](#br6)[the**](#br6)[** ](#br6)[odes,**](#br6)[** ](#br6)[the**](#br6)[** ](#br6)[following**](#br6)[** ](#br6)[figures**](#br6)[** ](#br6)[were**](#br6)[** ](#br6)[obtained:**](#br6)[** ](#br6)[-**](#br6)[**..........................6](#br6)

[THE](#br7)[ ](#br7)[MODEL](#br7)[ ](#br7)[WITH](#br7)[ ](#br7)[A](#br7)[ ](#br7)[SECONDARY](#br7)[ ](#br7)[TARGET](#br7)[ ](#br7)[OF](#br7)[ ](#br7)[INFECTION](#br7)[ ](#br7)[............................................................................7](#br7)

[**Introduction**](#br7)[**..............................................................................................................................................7](#br7)

[**Explanation:**](#br7)[** ](#br7)[-**](#br7)[**...........................................................................................................................................7](#br7)

[**Lymphocytes**](#br8)[** ](#br8)[(The**](#br8)[** ](#br8)[secondary**](#br8)[** ](#br8)[target**](#br8)[** ](#br8)[cells)**](#br8)[**.............................................................................................8](#br8)

[**Immune**](#br8)[** ](#br8)[responses**](#br8)[**....................................................................................................................................8](#br8)

[**Innate**](#br8)[** ](#br8)[immune**](#br8)[** ](#br8)[responses**](#br8)[**....................................................................................................................8](#br8)

[**Adaptive**](#br8)[** ](#br8)[immune**](#br8)[** ](#br8)[responses**](#br8)[**................................................................................................................8](#br8)

[**Data**](#br8)[** ](#br8)[used**](#br8)[** ](#br8)[for**](#br8)[** ](#br8)[this**](#br8)[** ](#br8)[Model:**](#br8)[** ](#br8)[-**](#br8)[**......................................................................................................................8](#br8)

[**Using**](#br9)[** ](#br9)[ode45**](#br9)[** ](#br9)[in**](#br9)[** ](#br9)[MATLAB**](#br9)[** ](#br9)[to**](#br9)[** ](#br9)[solve**](#br9)[** ](#br9)[the**](#br9)[** ](#br9)[odes,**](#br9)[** ](#br9)[the**](#br9)[** ](#br9)[following**](#br9)[** ](#br9)[figures**](#br9)[** ](#br9)[were**](#br9)[** ](#br9)[obtained:**](#br9)[** ](#br9)[-**](#br9)[**..........................9](#br9)

[CURVE](#br10)[ ](#br10)[FITTING](#br10)[ ](#br10)[FOR](#br10)[ ](#br10)[THE](#br10)[ ](#br10)[MODEL](#br10)[ ](#br10)[WITH](#br10)[ ](#br10)[A](#br10)[ ](#br10)[SECONDARY](#br10)[ ](#br10)[TARGET](#br10)[ ](#br10)[OF](#br10)[ ](#br10)[INFECTION](#br10)[ ](#br10)[.............................................10](#br10)

[Viral](#br11)[ ](#br11)[load](#br11)[ ](#br11)[data..............................................................................................................................................11](#br11)

[Curve](#br11)[ ](#br11)[fitting](#br11)[ ](#br11)[using](#br11)[ ](#br11)[lsqcurvefit](#br11)[ ](#br11)[in](#br11)[ ](#br11)[MATLAB....................................................................................................11](#br11)

[Curve](#br12)[ ](#br12)[fitting](#br12)[ ](#br12)[using](#br12)[ ](#br12)[fmincon](#br12)[ ](#br12)[with](#br12)[ ](#br12)[Non](#br12)[ ](#br12)[linear](#br12)[ ](#br12)[constraints](#br12)[ ](#br12)[and](#br12)[ ](#br12)[randomly](#br12)[ ](#br12)[generated](#br12)[ ](#br12)[initial](#br12)[ ](#br12)[values](#br12)[ ](#br12)[of](#br12)[ ](#br12)[the](#br12)

[parameters...................................................................................................................................................12](#br12)

[Curve](#br14)[ ](#br14)[fitting](#br14)[ ](#br14)[after](#br14)[ ](#br14)[data](#br14)[ ](#br14)[pre-processing........................................................................................................14](#br14)

[**Predicting**](#br16)[** ](#br16)[Viral**](#br16)[** ](#br16)[Dynamics**](#br16)[** ](#br16)[under**](#br16)[** ](#br16)[Treatment**](#br16)[** ](#br16)[**..................................................................................................16](#br16)

[**References**](#br18)[**.......................................................................................................................................................18](#br18)

[APPENDIX](#br19)[ ](#br19)[(](#br19)[ ](#br19)[CODES)..........................................................................................................................................19](#br19)

[Appendix](#br19)[ ](#br19)[A](#br19)[ ](#br19)[:](#br19)[ ](#br19)[Solving](#br19)[ ](#br19)[the](#br19)[ ](#br19)[Basic](#br19)[ ](#br19)[Viral](#br19)[ ](#br19)[Dynamic](#br19)[ ](#br19)[Model](#br19)[ ](#br19)[..................................................................................19](#br19)

[Appendix](#br21)[ ](#br21)[B:](#br21)[ ](#br21)[Solving](#br21)[ ](#br21)[the](#br21)[ ](#br21)[Model](#br21)[ ](#br21)[with](#br21)[ ](#br21)[a](#br21)[ ](#br21)[Secondary](#br21)[ ](#br21)[Target](#br21)[ ](#br21)[of](#br21)[ ](#br21)[Infection](#br21)[ ](#br21)[........................................................21](#br21)

[Appendix](#br23)[ ](#br23)[C:](#br23)[ ](#br23)[Curve](#br23)[ ](#br23)[Fitting](#br23)[ ](#br23)[with](#br23)[ ](#br23)[Lsqcurvefit..................................................................................................23](#br23)

[Appendix](#br25)[ ](#br25)[D:](#br25)[ ](#br25)[Final](#br25)[ ](#br25)[Curve](#br25)[ ](#br25)[Fitting](#br25)[ ](#br25)[using](#br25)[ ](#br25)[Fmincon](#br25)[ ](#br25)[...........................................................................................25](#br25)

[Appendix](#br37)[ ](#br37)[E:](#br37)[ ](#br37)[Viral](#br37)[ ](#br37)[Dynamics](#br37)[ ](#br37)[Under](#br37)[ ](#br37)[Treatment](#br37)[ ](#br37)[............................................................................................37](#br37)

3





**INTRODUCTION**

This study is about the virus that completely changed our lives. The virus that united the whole

world in the fight against it and the one that put so many countries under lockdown. SARS-CoV-2

was first detected in December 2019, in Wuhan, China and it is now a global pandemic.

It is crucial to understand how a virus reacts inside the host body to be able to come up with

treatment plans. Mathematical models help us in predicting the way a virus would react. In this

study, we would use mathematical models to observe the characteristic of SARS-Cov-2 virus. The

viral load data used in this paper was from patients in Germany (paper given in reference). Viral

RNA levels of all patients were collected every day using RT-PCR test. Then the models are fitted

to this data to observe the interaction between viral replication and host immune response.

The virus is transmitted through direct contact with

respiratory droplets of an infected person (e.g., Sneezing &

coughing). If the virus enters the lungs, it can invade the

tiny air sacs (alveoli) and cause pneumonia. At this point,

the lungs will become inflamed, blood oxygen level would

drop and it would become harder to breath. The

inflammation is due to the body’s immune response to the

infection.

Coronavirus targets type 2 pneumocytes.

These cells are responsible for transporting

fluid out of the airspace(lungs). When cells

are infected, the body’s immune response is

triggered which results in accumulation of

fluid in the air space and inflammation.

Because pneumocytes are then not able to

perform their function efficiently, this leads

to even more fluid accumulation in the

lungs. Due to this accumulated fluid in the

airspace, alveoli are not open for gas

exchange and the host has breathing problems. If the inflammation keeps increasing, it might cause

lung damage and the patient may require the use of life support systems.

4





**MATHEMATICAL MODELS**

**A BASIC VIRAL DYNAMIC MODEL: -**

**Introduction**

This is a very basic model that was studied to get a basic understanding of the virus. It only

includes target cells, infected cells and the virus.

Where,

The ODEs for the basic model are: -

T: Target Cells

V: Virus

푑푇/푑푡 = −훽푉 푇

푑퐼/푑푡= 훽푉 푇 − 훿퐼

푑푉/푑푡 = 푝퐼 – 푐푉

(1)

I: Infected cells

훽: Viral Infection rate

훿: Death rate

(2)

(3)

p: rate of production of virus per

infected cell

c: rate at which the virus is cleared

(1) Tells the rate at which the target cells,

pneumocytes are infected. It depicts the amount of uninfected target cells left after the virus

infected them at a mass action rate 훽푉 푇.

(2) This equation depicts the infected cells. The left-over infected cells would be the total

infected cells subtracted by the infected cells that die. We have assumed the death rate to be

a constant for this model, 2 cells per day.

(3) Shows the amount of virus left. The infected cells produce more virus at a rate p and the

virus is cleared out at a rate c.

**Data used for this Model: -**

Data used from Table S2. Best fits of model (1) to the URT viral load data in patients from

Germany. Patients chosen: #1 and #8

**Patient**

**β**

**p**

**c**

**V (0)**

**(ml/virus/day)**

**(day^-1)**

**(day^-1)**

**RNA/ml**

#1

#8

0.01

50

2

0.93

0.6

0.0001

0.0001

0.00091

Other data from the research article: -

훿= 2 cells /day

T (0) =60000 (Given number of target cells initially)

I (0) = 0 (Initially there would be no infected cells)

5





We have used Upper Respiratory Tract (URT) data instead of

LRT since it is easier to obtain samples from URT. The most

common test done for COVID-19 is the RT-PCR test, this gives

the URT data since sample is collected from the nasal cavity or

the throat. Collecting samples from the LRT is very difficult

and less common.

**Using ode45 in MATLAB to solve the odes, the following**

**figures were obtained: -**

Figure obtained for patient #1: - [(](#br19)[ ](#br19)[Code](#br19)[ ](#br19)[in](#br19)[ ](#br19)[Appendix](#br19)[ ](#br19)[A)](#br19)

Figure obtained for patient #8: - [(](#br19)[ ](#br19)[Code](#br19)[ ](#br19)[in](#br19)[ ](#br19)[Appendix](#br19)[ ](#br19)[A)](#br19)

6





**THE MODEL WITH A SECONDARY TARGET OF INFECTION**

**Introduction**

This represents the viral dynamics more accurately, by taking into account some more parameters: -

\1. A secondary target of infection (Lymphocytes)

\2. The death rate is a function instead of a constant

\3. Parameters that account for the adaptive immune response

The ODEs for this model are: -

Where,

푑푇₁/푑푡 = −훽푉 푇₁

푑푇₂/푑푡 = 휆−훽푉 푇₂

(1)

(2)

T₁: concentration of pneumocytes

T₂: concentration of lymphocytes

V: Virus

푑퐼/푑푡= 훽푉 (푇₁+ 푇₂) − [훿 (푡) + 휔푇₂] 퐼 (3)

I: Infected cells

훽: Viral Infection rate

푑푉/푑푡 = 푝퐼 – 푐푉

(4)

p: rate of production of virus per

infected cell

c: rate at which the virus is cleared

휆: Rate of recruitment of

lymphocytes

DEATH RATE: -

(5)

훿 (푡)= 훿ₒ for t< 휇

훿ₒ: Base death rate

휎: Parameter in the killing by

adaptive immune response

휇: Time of emergence of adaptive

immune response

훿 (푡)= 훿ₒ푒^(휎(푡−휇)) for t≥ 휇

**Explanation: -**

(1)푑푇₁/푑푡 = −훽푉 푇₁: Rate at which

pneumocytes are infected to generate infected cells.

This depicts the amount of pneumocytes left after the virus infects them.

(2)푑푇₂/푑푡 = 휆−훽푉 푇₂: Rate of recruitment of lymphocytes- rate of infection of lymphocytes.

This depicts the number of recruited lymphocytes left on the infection site after the virus

infects some of them at a mass action rate of 훽.

(3)푑퐼/푑푡= 훽푉 (푇₁+ 푇₂) − [훿 (푡) + 휔푇₂] 퐼: Total rate of infection- death rates of infected cells,

where 휔푇₂퐼 is death by innate immune response.

This depicts the number of infected cells left after some of them die.

(4)푑푉/푑푡 = 푝퐼 – 푐푉: rate of production – rate of clearance. This depicts the amount of virus left

over taking into account new virus produced from the infected cells and the clearance of

virus cells at a constant rate.

(5)The death rate is constant up to a certain time (assumed to me 2 cells/day). After day 휇, the

adaptive response kicks in and the death rate becomes an exponential function.

7





**Lymphocytes (The secondary target cells)**

These were taken as the secondary target since they were detected in a large number of infected

patients. They are present in white blood cells. They are recruited to the infection site due to the

lung inflammatory response. We presume the recruitment rate to be constant since the turnover of

uninfected lymphocytes is slow and they are usually constant in the body of a healthy person.

**Immune responses**

**Innate immune responses**

The innate immune responses are the first line of defense against invading pathogens. Innate

immune responses rely on the body's ability to recognize conserved features of pathogens that are

not present in the uninfected host.

For the model we presumed the concentration of lymphocytes to be proportional to innate immune

response. Therefore, 휔푇₂퐼 is clearance of infected cells by innate immune response.

**Adaptive immune responses**

Adaptive immunity is an immunity that occurs after exposure to an antigen either from a pathogen

or a vaccination. This part of the immune system is activated when the innate immune response is

insufficient to control an infection.

In the model it activates after day 휇 and the death rate of infected cells increases exponentially (훿

(푡)= 훿ₒ푒^(휎(푡−휇))).

**Data used for this Model: -**

Data used from Table 3: Best fits of model (3) to the URT viral load data in patients from Germany.

Patients chosen: #1 and #8

**Patient**

**β**

**p**

**c**

**V (0)**

휔

휎

휇

**(ml/virus/day) (day^-**

**1)**

**(day^- (ml/cell/day) (day−1) RNA/ml**

**1)**

#1

#8

1.1×10⁻⁵

7×10⁻⁶

940

3100

50

118

1.9×10⁻⁴

1.5×10⁻⁴

0.13

0.07

0.0001

0.0001

10

6

Other data from the research article: -

훿ₒ= 2 cells /day

Initial concentration of pneumocytes, T₁ (0) =60000

Initial concentration of lymphocytes, T₂ (0) =0

휆=10⁴ per day

I (0) = 0 (Initially there would be no infected cells)

8





**Using ode45 in MATLAB to solve the odes, the following figures were obtained: -**

Figure obtained for patient #1: - [Code](#br21)[ ](#br21)[in](#br21)[ ](#br21)[Appendix](#br21)[ ](#br21)[B](#br21)

Figure obtained for patient #8: - [Code](#br21)[ ](#br21)[in](#br21)[ ](#br21)[Appendix](#br21)[ ](#br21)[B](#br21)

Therefore, to conclude ode45 to solve the ODEs representing the model since they give an accurate

representation of the observed viral trends.

There are still a few drawbacks to using this model. We have assumed that the virus infects both the

targets cells at the same rate, this may not be the case in real life. To make this more realistic we

can take two different kinds of infected cells that were generated from the two target cells

respectively, with different virus production and clearance rate. We have also not taken into

account the natural death rate of the target cells. Many more parameters can be added to this model,

but it would make solving it very difficult. Therefore, we try our best to minimise the number of

parameters.

The next steps in this project would be to do curve fitting of the given viral load data to obtain the

values of the unknown parameters of the model 3. If successful, we can then use this model for

other data sets as well.

9





CURVE FITTING FOR THE MODEL WITH A SECONDARY TARGET OF

INFECTION

In this process, the viral load data collected from each patient every day, is plotted and using the

mathematical model and different initial guesses for the six parameters to be fitted, the final value

of the parameters is to be found out.

Getting proper curve fitting is a tedious task and various methods were tried out before we got

accurate fittings for all patients.

The following steps were carried out:-

\1. Extracting Viral Load data to be used for the fitting. ( This was done for 8 patients from the

reference paper)

\2. Curve fitting using lsqcurvefit in MATLAB. This did not give accurate results.

\3. Curve fitting after generating random initial values for the parameters to be fitted, using

fmincon in MATLAB and applying non linear constraints.

\4. Curve fitting after data preprocessing: Replacing outliers using filloutliers in MATLAB.

Fitting without outliers was giving incorrect fitting.

( Each task has been explained in details later)

Parameters to be fitted are:-

\1. 훽: Viral Infection rate

\2. p: rate of production of virus per infected cell

\3. c: rate at which the virus is cleared

\4. 휎: Parameter in the killing by adaptive immune response (determines how fast the death rate

increases)

\5. 휇: Time of emergence of adaptive immune response

\6. 휔: Killing rate by innate immune response

10





**Viral load data**

The viral load data was obtained from a research paper which included clinical observations of

patients in Germany. RT-PCR test was used and the viral load kinetics was plotted as shown:-

Since in this project we were interested in the URT data, we extracted that data for all patients

from the graphs for the swab data ( yellow). Extraction was done using an online graph reader.

**Curve fitting using lsqcurvefit in MATLAB**

Lsqcurvefit is an inbuilt function in MATLAB that solves non-linerar curve fitting (data-fitting)

problems with least-squares method. Steps carried out for the curve fitting :-

• The extracted viral load data was placed into the code, we would use these data points to do

the curve fitting in MATLAB using lsqcurvefit.

• Initial guesses for the six parameters to be fitted are assumed and then the output is

observed.

• We first use the parameter values given in the reference paper itself to check the output and

then make slight changes to the initial guess and observe the changes in the output.

• 4 different initial parameter guesses for each patient were taken.

11





**Conclusion**:-

The fitted parameter values returned by the code depend mainly upon the initial guesses used.

No consistency could be seen in the outputs. Therefore, it was concluded that lsqcurvefit is not

a good option to do the curve fitting. [(](#br23)[ ](#br23)[Code](#br23)[ ](#br23)[in](#br23)[ ](#br23)[Appendix](#br23)[ ](#br23)[C](#br23)[ ](#br23))

Patient 1

Patient 8

**Curve fitting using fmincon with Non linear constraints and**

**randomly generated initial values of the parameters**

Fmincon is a nonlinear programming solver that minimizes the objective function bound to linear

or non linear constraints. Steps carried out:-

• Random variables were generated for each of the 6 parameters under appropriate upper &

lower bounds. (60 for each parameter)

• The non linear constraint of y(4)>0.01 or log10(y(4))>-2 was applied while performing the

fitting. ( here y(4) is the Virus values) { Under the assumption that the virus cannot be

detected below this level while testing }

• 61 cases of fitting was done for all the 8 patients.

Where, Case 1:- using the parameter values given in the reference paper as the initial guess

and rest 60 cases:- from random variable generation

• The output for each patient given was stored in excel and the error values for each case was

compared with the error of the paper by calculating the percentage reduction.

12





**For each patient, no. of cases better than the paper:-**

**No. of cases with**

**error less than that**

**Percentage of**

**cases better than**

**Patient no of the paper (out of 61) the paper**

1

2

3

4

7

8

10

14

52

52

15

54

57

8

85.25%

85.25%

24.59%

88.52%

93.44%

13.11%

83.61%

96.72%

51

59

**Best fitted graphs obtained for all the patients**

It can be observed that the curve is not passing through most data points for most patients. This is

because of the presence of outliers. So, we then looked into methods to detect and replace outliers.

13





**Curve fitting after data pre-processing**

Since we were getting incorrect curve fitting due to the outliers, an inbuilt function in MATALB,

filloutliers was used to detect & replace them. filloutliers(A,fillmethod,findmethod) detects outliers

in A using the method specified in ‘findmethod’ and replaces them according to the method in

‘fillmethod’.

We tested two kinds of methods to detect the outliers:-

\1. **Quartiles**

Outliers are defined as elements more than 1.5 interquartile ranges above the upper quartile

(75 percent) or below the lower quartile (25 percent). This method is useful when the data is

not normally distributed.

\2. **Threshold [ 10 90]**

A threshold of [10 90] defines outliers as points below the 10th percentile and above the

90th percentile.

Upon running 60 cases for both of these for all the patients, it was concluded that Quartiles gave

better results ( based on error and visual representation).

**‘clip’ method was used to replace the outliers.**

It fills with the lower threshold value for elements smaller than the lower threshold determined by

findmethod. Fills with the upper threshold value for elements larger than the upper threshold

determined by findmethod. [(](#br25)[ ](#br25)[Code](#br25)[ ](#br25)[in](#br25)[ ](#br25)[Appendix](#br25)[ ](#br25)[D](#br25)[ ](#br25))

**Best fitted graphs for all patients using Quartiles as outliers detection method**

PATIENT 1

PATIENT 3





**Parameter Values obtained for each patient after fitting**

**β**

휇

**p**

**c**

휔

**Patient**

**(ml/virus/day)** 휎 **(day−1)**

**(days)**

**(day^-1)**

**(day^-1)**

**(ml/cell/day)**

**1**

0.0000165

0.0380706 14

0.1821148 10

0.0091126

14476.42

31.16571

**2**

1.01008E-05

0.000000299

0.00000893

6.59E-06

0.01

0.0011458

0.01

78925.114 80.38738

**3**

0.02929

12

10

6

100000

26.77858

60.80413

**4**

0.2386817

0.0729415

0.2099361

0.2685314

0.1666006

67283.691

**7**

0.0095497

0.0046554

0.01

29980.462 21.31287

**8**

0.0000786

0.0000187

0.0000172

6

1922.0378

19134.965

100000

32.17586

35.65845

171.9629

**10**

**14**

13

6

0.01

[(](#br25)[ ](#br25)[Code](#br25)[ ](#br25)[in](#br25)[ ](#br25)[Appendix](#br25)[ ](#br25)[D](#br25)[ ](#br25))

15





**Predicting Viral Dynamics under Treatment**

We compared the effect on viral dynamics when treatment was started on different days after the

symptoms started showing. We also observed the effect on viral dynamics upon using drugs with

different efficacies. This drug would have two effects. Firstly, we would factor in its ability to

eliminate the virus. Secondly, we would factor in it’s ability to prevent the target cells, pneunocytes

from becoming effected. For these, we would make a few changes to the equations of the model

used before.

Modifications made to the equations of the model with secondary target of infection:-

\1. The 4th equation would be modified as follows for the days after the treatment is started:-

푑푉/푑푡 =((1-e)\* 푝퐼) – 푐푉, where e is the efficacy of the drug to eliminate virus particles

\2. The 1st equation would be modified as follows for the days after the treatment is started:-

푑푇₁/푑푡 = −훽푉 푇₁(1-N), where N represents the efficacy of the drug to reduce the infection

rate of pneumocytes ,i.e, preventing 푇₁ from becoming V.

\3. The third equation is modified as follows for the days after the treatment is started to

account for the modified 푇₁:-

푑퐼/푑푡= 훽푉( 푇₁(1-N)+ 푇₂)−[훿 (푡) + 휔푇₂]퐼

[(](#br37)[ ](#br37)[Code](#br37)[ ](#br37)[in](#br37)[ ](#br37)[Appendix](#br37)[ ](#br37)[E](#br37)[)](#br37)

**Considering only the efficacy of the drug to eliminate virus particles**

**It can be observed that a drug with a higher efficacy would eliminate the virus faster.Starting**

**the treatment earlier would eliminate the virus earlier for all cases.**

16





**Considering both the effects of the drug**

It can be observed that as the efficacy of the drug to reduce the infection rate of pneumocytes(

preventing 푇₁ from becoming V) increases, we see a change in the shape of the curve. The peak of

the Virus decreases, i.e., overall quantity of virus decreases. ( [Code](#br37)[ ](#br37)[in](#br37)[ ](#br37)[Appendix](#br37)[ ](#br37)[E](#br37)[)](#br37)

**Therefore, it can be concluded that higher efficacy drugs are better for eliminating the virus**

**faster as well as decreasing the quantity of the virus. Starting the treatment earlier would**

**eliminate the virus earlier.**

17





**References**

(1) Sunpeng Wang,Yang Pan,Quanyi Wang, Hongyu Miao,Ashley N.Brown,Libin Rong,

Modeling the viral dynamics of SARS-CoV-2 infection, (2020),

<https://doi.org/10.1016/j.mbs.2020.108438>[ ](https://doi.org/10.1016/j.mbs.2020.108438).

(2) R. Wölfel, V.M. Corman, W. Guggemos, M. Seilmaier, S. Zange, M.A. Müller,et al.,

Virological assessment of hospitalized patients with COVID-2019, Nature (2020)

<http://dx.doi.org/10.1038/s41586-020-2196-x>[ ](http://dx.doi.org/10.1038/s41586-020-2196-x).

(3) <https://in.mathworks.com/help/matlab/ref/ode45.html>

(4) <http://www.graphreader.com/>[ ](http://www.graphreader.com/)( Used to extract Data from the graphs)

(5) <https://in.mathworks.com/help/optim/ug/lsqcurvefit.html>

(6) <https://in.mathworks.com/help/optim/ug/fmincon.html>

(7) <https://in.mathworks.com/help/matlab/ref/rmoutliers.html>

(8) [https://in.mathworks.com/help/matlab/data_analysis/data-smoothing-and-outlier-](https://in.mathworks.com/help/matlab/data_analysis/data-smoothing-and-outlier-detection.html)

[detection.html](https://in.mathworks.com/help/matlab/data_analysis/data-smoothing-and-outlier-detection.html)

(9) <https://www.ruf.rice.edu/~bioslabs/tools/data_analysis/errors_curvefits.html>

(10) <https://statisticsbyjim.com/basics/outliers/>

(11) <https://www.who.int/emergencies/diseases/novel-coronavirus-2019>

(12) [https://www.fda.gov/media/136151/download#:~:text=The%20COVID%2D19%20RT%2](https://www.fda.gov/media/136151/download#:~:text=The%20COVID%2D19%20RT%2DPCR%20Test%20is%20a%20real%2D,tract%20aspirates%2C%20bronchoalveolar%20lavage%2C%20and)

[DPCR%20Test%20is%20a%20real%2D,tract%20aspirates%2C%20bronchoalveolar%20la](https://www.fda.gov/media/136151/download#:~:text=The%20COVID%2D19%20RT%2DPCR%20Test%20is%20a%20real%2D,tract%20aspirates%2C%20bronchoalveolar%20lavage%2C%20and)

[vage%2C%20and](https://www.fda.gov/media/136151/download#:~:text=The%20COVID%2D19%20RT%2DPCR%20Test%20is%20a%20real%2D,tract%20aspirates%2C%20bronchoalveolar%20lavage%2C%20and)

18





APPENDIX (CODES)

**Appendix A: Solving the Basic Viral Dynamic Model**

**Using ode45 to Solve the Basic Viral Dynamic Model**

MATLAB CODES: -

Definition of the function: - This code would be the same for both the patients

1.%Declaration of the ODEs

2.function dy=temp(t,y)

\3.

4.global B D p c

5.dy=zeros(length(y),1);

\6.

7.dy(1)=p\*y(3)-c\*y(1);

8.dy(2)=(-1\*B)\*y(1)\*y(2);

9.dy(3)=B\*y(1)\*y(2)-D\*y(3);

\10.

\11.

\12.

\13.

\14.

\15.

\16.

%y(1): Virus(V)

%y(2): Target Cells(T)

%y(3): Infected Cells(I)

End

Code to solve the equations using ode45:-

This would be slightly different for both the patients because of the change in values of 훽,p and c.

Patient #1 :-

\1. %Solving the ODEs using RK-Method

\2.

\3. close all

\4. clear all

\5. global B D p c

\6.

\7. B=0.01;

\8. D=2;

\9. p=50;

\10. c=0.93;

\11.

\12. tend=30; %30 days

\13. tspan=0:tend;

\14. y0=[0.0001 60000 0];

19





\15. [t y]=ode45('temp',tspan,y0);

\16. plot(t,y)

\17. xlabel('Time(Days)')

\18. ylabel('No. of copies per ml')

\19. legend({'y1 = Virus','y2 = Target cells', 'y3=Infected

cells'},'Location','northeast')

**Patient #8:-**

1.%Solving the ODEs using RK-Method

\2.

3.close all

4.clear all

5.global B D p c

\6.

7.B=0.00091;

8.D=2;

9.p=2;

\10. c=0.6;

\11.

\12. tend=30; %30 days

\13. tspan=0:tend;

\14. y0=[0.0001 60000 0];

\15. [t y]=ode45('temp',tspan,y0);

\16. plot(t,y)

\17. xlabel('Time(Days)')

\18. ylabel('No. of copies per ml')

\19. legend({'y1 = Virus','y2 = Target cells', 'y3=Infected

cells'},'Location','northeast')

20





**Appendix B: Solving the Model with a Secondary Target of**

**Infection**

**Using ode45 to solve the model with a secondary target of infection**

MATLAB CODES:-

Function defining the ODEs :- This code would be the same for both the patients

\1. function dy=virus(t,y)

\2.

3.global B p c D w sig U L

4.dy=zeros(length(y),1);

\5.

6.dy(1)=(-1\*B)\*y(4)\*y(1);

7.dy(2)=L-(B\*y(4)\*y(2));

8.dy(3)=B\*y(4)\*(y(1)+y(2))-(death(t)+(w\*y(2)))\*y(3);

9.dy(4)=p\*y(3)-c\*y(4);

\10.

\11.

\12.

\13.

\14.

\15.

\16.

%y(1): T1

%y(2): T2

%y(3): I

%y(4): V

end

Function defining the death rate:-

1.function f=death(t)

2.global D sig U

3.f=D\*exp(sig\*(t-U));

4.end

Code to solve the equations using ode45:-

This would be slightly different for both the patients because of the change in values of 훽,p and c.

Patient #1 :-

\1. %Solving the ODEs using RK-Method

\2. close all

\3. clear all

\4. global B p c D w sig U L

\5.

\6. B=1.1\*10^(-5);

\7. D=2; %given

\8. p=940;

\9. c=50;

\10. w= 1.9\*10^(-4);

\11. sig=0.13;

21





\12. U=10;

\13. L=10000

\14.

\15.

\16. tend=25; %25 days

\17. tspan=0:tend;

\18. y0=[60000 0 0 0.0001];

\19. [t y]=ode45('virus',tspan,y0);

\20. Y=log10(y)

\21. Y(Y<0)=0

\22.

\23. plot(t,Y)

\24. xlabel('Time(Days)')

\25. ylabel('log10 copies per ml')

\26. legend({'T1 = Conc of Pneumocytes','T2 = conc of Lymphocytes', 'I=Infected

cells','V=Virus'},'Location','northeast')

**Patient #8:-**

1.%Solving the ODEs using RK-Method

2.close all

3.clear all

4.global B p c D w sig U L

\5.

6.B=7\*10^(-6);

7.D=2; %given

8.p=3100;

9.c=118;

\10. w= 1.5\*10^(-4);

\11. sig=0.07;

\12. U=6;

\13. L=10000

\14.

\15. tend=30; %30 days

\16. tspan=0:tend;

\17. y0=[60000 0 0 0.0001];

\18. [t y]=ode45('virus',tspan,y0);

\19.

\20. Y=log10(y)

\21. Y(Y<0)=0

\22.

\23. plot(t,Y)

\24. xlabel('Time(Days)')

\25. ylabel('log10 copies per ml')

\26. legend({'T1 = Conc of Pneumocytes','T2 = conc of Lymphocytes',

'I=Infected cells','V=Virus'},'Location','northeast')

22





**Appendix C: Curve Fitting with Lsqcurvefit**

**Curve fitting of the model with a secondary target of infection with lsqcurvefit**

**Function Defining the odes:-**

1.function dy=odes(t,y,b)

\2.

3.%b is the array of constants that need to be fitted

4.B=b(1);

5.p=b(2);

6.c=b(3);

7.sigma=b(4);

8.U=b(5);

9.w=b(6);

\10.

\11.

\12.

\13.

\14.

\15.

\16.

\17.

\18.

\19.

\20.

\21.

\22.

\23.

\24.

\25.

\26.

\27.

\28.

dy=zeros(length(y),1);

dy(1)=(-1\*B)\*y(4)\*y(1);

dy(2)=10000-(B\*y(4)\*y(2));

dy(3)=B\*y(4)\*(y(1)+y(2))-(die(t,b)+(w\*y(2)))\*y(3);

dy(4)=p\*y(3)-c\*y(4);

%y(1): T1

%y(2): T2

%y(3): I

%y(4): V

%b(1)=B(Beta)

% b(2)=p; b(3)=c

%b(4)=sigma

%b(5)=U(mu)

%b(6)=w(omega)

End

**Function used to do fitting :-**

1.function X= odefit(b,t)

2.tend=30; %30 days

3.tspan=0:tend;

\4. y0=[60000 0 0 0.0001];

5.[t y]=ode45(@(t,y) odes(t,y,b),t,y0);

6.X=y(:,4);

7.End

**Main code :-**

1.clc

2.clear

3.%PATIENT 8

\4.

5.observations= [6

12589.25412

6.7 6309.573445

23





7.8 4466.835922

8.9 2818.382931

9.10 39.81071706

\10. 11 125.8925412

\11. 12 89.12509381

\12. 13 39.81071706

\13. 14 316.227766

\14. 15 63.09573445

\15. 16 1

\16. 17 1

\17. 18 15.84893192

\18. 19 39.81071706

\19. 20 1

\20. 21 1

\21. ];

\22.

\23. t\_obs = observations(:,1);

\24. v1\_obs = observations(:,2);

\25. %parameters to be fitted

\26. beta=7\*10^(-6);

\27. pp=3100;

\28. cc=118;

\29. omega= 1.5\*10^(-4);

\30. sigma=0.07;

\31. mu=6;

\32. %Initial concentrations

\33. t1=60000;

\34. t2=0;

\35. I=0;

\36. V=0.0001;

\37. %Initial conditions

\38. X0 = [beta;pp;cc;omega;sigma;mu];

\39. lb=[0;0;0;0;0;0];

\40. % %durataion of the experiment

\41. tstart = 4;

\42. tend = 22; %days

\43. tspan = [tstart tend];

\44.

\45. B = lsqcurvefit(@(b,t)odefit(b,t), X0, t\_obs, v1\_obs,lb);

\46.

\47. figure

\48. plot(observations(:,1), observations(:,2:end),'p')

\49. hold on

\50. plot(observations(:,1), odefit(B,observations(:,2)))

\51. xlabel('Time(Days)')

\52. ylabel('number of copies per ml')

\53. hold off

\54. grid

24





**Appendix D: Final Curve Fitting using Fmincon**

**This was the Final code used to do curve fitting for the model with a secondary target of infection.**

**Defining the mathematical model**

1.function dy = model(t,y,b)

2.%% This is the function that is used in ode45

\3.

4.% b(1) : beta

5.% b(2) : sigma

6.% b(3) : meu

7.% b(4) : omega

8.% b(5) : p

9.% b(6) : c

\10.

\11.

\12.

\13.

\14.

\15.

\16.

\17.

dy(1) = -b(1)\*y(4)\*y(1); % T1

dy(2) = 10^4 - b(1)\*y(4)\*y(2); % T2

% This is the part euivalent to death function

if(t >= b(3))

dy(3) = b(1)\*y(4)\*(y(1) + y(2)) - (2\*exp(b(2)\*(t-b(3))) +

b(4)\*y(2))\*y(3); % I

\18.

\19.

\20.

\21.

\22.

\23.

\24.

\25.

\26.

\27.

else

dy(3) = b(1)\*y(4)\*(y(1) + y(2)) - (2 + b(4)\*y(2))\*y(3); % I

end

%

dy(4) = b(5)\*y(3) - b(6)\*y(4); % V

dy = dy';

End

**Non-linear Constraints**

1.function [c,ceq] = constraints(x,limit,t\_actual,y0,v\_actual)

\2.

3.[~, conc] = ode45(@(t,y) model(t,y,x),t\_actual,y0);

\4. v\_ode = conc(2:end,4);

\5.

\6. c= ((-1)\*v\_ode)+limit;

7.ceq=[];

8.%

\9.

\10.

end

\11.

25





**Fitting Function**

1.function sol = fitness\_function(x,y0,t\_actual,v\_actual)

2.[~, conc] = ode45(@(t,y) model(t,y,x),t\_actual,y0);

3.v\_ode = conc(:,4);

4.sol =sum((v\_ode - v\_actual).^2);

\5.

6.end

**Main**

1.%%

2.%% CURVE FITTING BY GENERATING RANDOM VARIABLES AS INITIAL GUESSES FOR

PATIENT 14

3.% Threshold

\4.

5.%%

6.%% This is the main function

\7.

\8.

9.subtit= sprintf('PATIENT 14');

\10.

\11.

\12.

\13.

\14.

\15.

\16.

\17.

\18.

\19.

\20.

\21.

\22.

\23.

\24.

\25.

\26.

\27.

\28.

\29.

\30.

\31.

\32.

\33.

\34.

\35.

\36.

\37.

\38.

\39.

\40.

\41.

%%

%% Parameters to be fitted

% %Patient 1

% beta = 1.1\*10^(-5);

% p = 940;

% c = 50;

% omega = 1.9\*10^(-4);

% sigma = 0.13;

% meu = 10;

% %Patient 2

% beta = 2.2\*10^(-6);

% p = 4.8\*10^(3);

% c = 35;

% omega = 3\*10^(-4);

% sigma = 0.01;

% meu = 8;

% %Patient 3

% beta = 9.8\*10^(-6);

% p = 1.3\*10^(3);

% c = 58;

% omega = 2\*10^(-4);

% sigma = 0.04;

% meu = 9;

% %Patient 4

% beta = 4.5\*10^(-5);

26





\42.

\43.

\44.

\45.

\46.

\47.

\48.

\49.

\50.

\51.

\52.

\53.

\54.

\55.

\56.

\57.

\58.

\59.

\60.

\61.

\62.

\63.

\64.

\65.

\66.

\67.

\68.

\69.

\70.

\71.

\72.

\73.

\74.

\75.

\76.

\77.

\78.

\79.

\80.

\81.

\82.

\83.

\84.

\85.

\86.

\87.

\88.

\89.

\90.

\91.

\92.

\93.

\94.

\95.

% p = 88;

% c = 5;

% omega = 0.001;

% sigma = 0.001;

% meu = 6;

% %Patient 7

% beta = 9.9\*10^(-7);

% p = 1.08\*10^(4);

% c = 48;

% omega = 2.1\*10^(-4);

% sigma = 10^(-4);

% meu = 9;

% %Patient 8

% beta = 7\*10^(-6);

% p = 3100;

% c = 118;

% omega = 1.5\*10^(-4);

% sigma = 0.07;

% meu = 6;

% %Patient 10

% beta = 1.8\*10^(-6);

% p = 4.9\*10^(3);

% c = 3.5;

% omega = 3\*10^(-3);

% sigma = 0;

% meu = 15;

%Patient 14

beta = 5.7\*10^(-6);

p = 800;

c = 10;

omega = 5.3\*10^(-4);

sigma = 0;

meu = 6;

%%

%% The vector b stores all fitting parameters

b(1) = beta;

b(2) = sigma;

b(3) = meu;

b(4) = omega;

b(5) = p;

b(6) = c;

%%

%% Initial Conditions

T1 = 60000;

27





\96.

T2 = 0;

\97.

I = 0;

\98.

V = 0.0001;

\99.

\100.

\101.

\102.

\103.

\104.

\105.

\106.

\107.

\108.

\109.

\110.

\111.

\112.

\113.

\114.

\115.

\116.

\117.

\118.

\119.

\120.

\121.

\122.

\123.

\124.

\125.

\126.

\127.

\128.

\129.

\130.

\131.

\132.

\133.

\134.

\135.

\136.

\137.

\138.

\139.

\140.

\141.

\142.

\143.

\144.

\145.

\146.

\147.

\148.

\149.

y0 = [T1;T2;I;V]; % Storing Initial Conditions

%%

%% Solving system of ODEs using ode45

t\_start = 0;

t\_end = 30;

t\_span = [t\_start:t\_end];

[time, conc] = ode45(@(t,y) model(t,y,b),t\_span,y0);

%%

%% Viral Load Data

% %Patient 1

% observations=[

% 4 79432823.4724

% 5 10000.0000

% 6 1.0000

% 7 15.8489

% 8 1412.5375

% 9 70.7946

% 10

% 11

% 12

% 13

% 14

% 15

% 16

% 17

% 18

% 19

501.1872

12.5893

100.0000

1.0000

1412.5375

1.0000

1.0000

1.0000

1.0000

1.0000

% 20 1.0000

% 21 1.0000

% 22 1.0000

% ];

% % Patient 2

% observations=[

%

3 49203953.57

% 4 1324341.535

% 5 86297.85478

% 6 35563.13186

% 7 17021.58508

% 8 25.70395783

% 9 457.0881896

% 10

% 11

% 12

% 13

% 14

83.75292821

1

1

14.25607594

16.51961798

28





\150.

\151.

\152.

\153.

\154.

\155.

\156.

\157.

\158.

\159.

\160.

\161.

\162.

\163.

\164.

\165.

\166.

\167.

\168.

\169.

\170.

\171.

\172.

\173.

\174.

\175.

\176.

\177.

\178.

\179.

\180.

\181.

\182.

\183.

\184.

\185.

\186.

\187.

\188.

\189.

\190.

\191.

\192.

\193.

\194.

\195.

\196.

\197.

\198.

\199.

\200.

\201.

\202.

\203.

% 15

% 16

% 17 1

% 18

% 19

% 20

% ];

1

1

1

1

1

% % %Patient 3

% observations=[

%

3 1640589.773

% 4 151008.0154

% 5 18323.14422

% 6 6683.439176

% 7 4216.965034

% 8 269.1534804

% 9 62.08690342

% 10

% 11

% 12

% 13

% 14

% 15

% 16

% 17

% 18

% 19

% 20

% 21

% 22

% ];

1

47.09773264

35.80964371

186.6379691

1

1

3.962780343

1

14.28893959

39.26449354

24.77422058

1

1

%

% %Patient 4

% observations=[

%

4 2371373.706

% 5 104712.8548

% 6 739.6052751

% 7 4623.810214

% 8 29.78516429

% 9 27.16439269

% 10

% 11

% 12

% 13

% 14

% 15

% 16

% 17

% 18

% 19

% ];

1

1

22.64644308

42.95364268

1

1

1

1

1

1

29





\204.

\205.

\206.

\207.

\208.

\209.

\210.

\211.

\212.

\213.

\214.

\215.

\216.

\217.

\218.

\219.

\220.

\221.

\222.

\223.

\224.

\225.

\226.

\227.

\228.

\229.

\230.

\231.

\232.

\233.

\234.

\235.

\236.

\237.

\238.

\239.

\240.

\241.

\242.

\243.

\244.

\245.

\246.

\247.

\248.

\249.

\250.

\251.

\252.

\253.

\254.

\255.

\256.

\257.

% %Patient 7

% observations=[

%

4 582103217.8

% 5 453941.6167

% 6 287078.0582

% 7 511.6818355

% 8 87096.359

% 9 1849.268619

% 10

% 11

% 12

% 13

% 14

% 15

% 16

% 17

% 18

% 19

% 20

% 21

% 22

% 23

% 24

% 25

% 26

% 27

% ];

887.156012

18.83649089

1.202264435

35.80964371

68.07693587

39.26449354

35.80964371

39.26449354

1

62.08690342

1

1

1

1

1

1

1

1

% %Patient 8

% observations= [

% 6 12589.25412

% 7 6309.573445

% 8 4466.835922

% 9 2818.382931

% 10

% 11

% 12

% 13

% 14

% 15

% 16

% 17

% 18

% 19

% 20

% 21

% ];

39.81071706

125.8925412

89.12509381

39.81071706

316.227766

63.09573445

1

1

15.84893192

39.81071706

1

1

% %Patient 10

% observations=[

%

4 787045.7897

30





\258.

\259.

\260.

\261.

\262.

\263.

\264.

\265.

\266.

\267.

\268.

\269.

\270.

\271.

\272.

\273.

\274.

\275.

\276.

\277.

\278.

\279.

\280.

\281.

\282.

\283.

\284.

\285.

\286.

\287.

\288.

\289.

\290.

\291.

\292.

\293.

\294.

\295.

\296.

\297.

\298.

\299.

\300.

\301.

\302.

\303.

\304.

\305.

\306.

\307.

\308.

\309.

\310.

\311.

% 5 199067.3339

% 6 66221.65037

% 7 15240.52754

% 8 4216.965034

% 9 3206.269325

% 10

% 11

% 12

% 13

% 14

% 15

% 16

% 17

% 18

% 19

% 20

% 21

% 22

% 23

% 24

% 25

% 26

% 27

% 28

% ];

58748935.25

497737.085

5559.042573

16710.90614

2432.204009

22029.26463

170.2158508

809.0958992

10.86425624

42.95364268

674.5280277

32.65878322

1.318256739

1

18.83649089

1

15.6675107

1

1

%Patient 14

observations=[

2 13182.56739

3 131825.6739

4 144543.9771

5 208929.6131

6 63095.73445

7 83176.37711

8 208.9296131

9 75.8577575

10 1

11 20.89296131

12 10.96478196

13 1

14 1

15 1

];

%%

%%

t\_actual = observations(:,1);

v\_actua = [V;observations(:,2)];

%Case 1

%v\_actual = filloutliers(v\_actua,'clip','quartiles');

31





\312.

\313.

\314.

\315.

\316.

\317.

\318.

\319.

\320.

\321.

\322.

\323.

\324.

\325.

\326.

\327.

\328.

\329.

\330.

\331.

\332.

\333.

\334.

\335.

\336.

\337.

\338.

\339.

\340.

\341.

\342.

\343.

\344.

\345.

\346.

\347.

\348.

\349.

\350.

\351.

\352.

\353.

\354.

\355.

\356.

\357.

\358.

\359.

\360.

\361.

\362.

\363.

\364.

%Case 2

threshold=[10 90];

v\_actual = filloutliers(v\_actua,'clip','percentiles',threshold);

% count=0;

%

% for j=1:length(v\_actual)

%

%

%

if(v\_actual(j)~= v\_actua(j))

count=count+1;

end

% end

%

% count

[time, conc\_paper] = ode45(@(t,y) model(t,y,b),[0;t\_actual],y0);

sol\_rmse\_paper = sum((conc\_paper(:,4) - v\_actual).^2);

er= sprintf('Error from the paper = %d \n',sol\_rmse\_paper);

disp(er);

options.Display = 'iter';

options.Algorithm = 'sqp';

%%

%%

%%Values of the parameters from the paper

% %Patient 1

% b0 = [1.1\*10^(-5);0.13;10;1.9\*10^(-4);940;50];

% %Patient 2

% b0 = [2.2\*10^(-6);0.01;8;3\*10^(-4);4.8\*10^(3);35];

% %Patient 3

% b0 = [9.8\*10^(-6);0.04;9;2\*10^(-4);1.3\*10^(3);58];

%

% %Patient 4

% b0 = [4.5\*10^(-5);0.001;6;0.001;88;5];

% %Patient 7

% b0 = [9.9\*10^(-7);0.0001;9;2.1\*10^(-4);1.08\*10^(4);48];

32





\365.

\366.

\367.

\368.

\369.

\370.

\371.

\372.

\373.

\374.

\375.

\376.

\377.

\378.

% %Patient 8

% b0 = [7\*10^(-6);0.07;6;1.5\*10^(-4);3100;118];

% %Patient 10

% b0 = [1.8\*10^(-6);0;15;3\*10^(-3);4.9\*10^(3);3.5];

%Patient 14

b0 = [5.7\*10^(-6);0;6;5.3\*10^(-4);800;10];

disp('Initial Values for Case 1:-');

Xi = sprintf('Beta: %d \nSigma: %d \nMeu: %d \nOmega: %d \np: %d

\nc: %d\n\n',b0(1),b0(2),b0(3),b0(4),b0(5),b0(6));

\379.

disp(Xi);

\380.

\381.

\382.

\383.

\384.

\385.

\386.

\387.

\388.

\389.

\390.

%%

%%

%% Ode Fitting

% This limit signifies the inequality where all the log10 values

%must be greater than or equal to -2

limit=0.01;

[x,sol\_rmse\_fitted] =

fmincon(@(x)fitness\_function(x,y0,[0;t\_actual],v\_actual),b0,[],[],[],[],[1

0^(-8);0;6;10^(-

5);10;0.5],[0.0001;0.5;15;0.01;10^5;300],@(x)constraints(x,limit,[0;t\_actu

al],y0,v\_actual),options);

\391.

[time, conc\_fitted] = ode45(@(t,y) model(t,y,x),[0;t\_actual],y0);

% We need it for the plot function

\392.

\393.

\394.

\395.

%%

disp('Final Value for Case 1 :-');

Xf = sprintf('Beta: %d \nSigma: %d \nMeu: %d \nOmega: %d \np: %d

\nc: %d\n\n',x(1),x(2),x(3),x(4),x(5),x(6));

\396.

disp(Xf);

\397.

\398.

\399.

\400.

\401.

err0= sprintf('Error for Case 1 = %d ',sol\_rmse\_fitted);

disp(err0);

%Storing the Values properly in cells so that data can be observed

in Excel

\402.

\403.

\404.

\405.

\406.

\407.

\408.

\409.

\410.

%easily

result{1,1}='Error';

result{1,2} ='Beta(initial)';

result{1,3} ='Beta(final)';

result{1,4} ='Sigma(initial)';

result{1,5} ='Sigma(final)';

result{1,6} = 'Meu(initial)';

result{1,7} = 'Meu(Final)';

result{1,8} = 'Omega(Initial)';

33





\411.

\412.

\413.

\414.

\415.

\416.

\417.

\418.

result{1,9} = 'Omega(Final)';

result{1,10} ='p (Initial)';

result{1,11} = 'p (Final)';

result{1,12} = 'c(Initial)';

result{1,13} = 'c(Final)';

result{1,14} = 'V values';

%Fitting data obtained for Case 1( using the actual value of

parameters

\419.

\420.

\421.

\422.

\423.

\424.

\425.

\426.

\427.

\428.

\429.

\430.

\431.

\432.

\433.

\434.

\435.

\436.

\437.

\438.

\439.

\440.

\441.

\442.

\443.

\444.

\445.

\446.

\447.

\448.

\449.

\450.

\451.

\452.

\453.

\454.

\455.

\456.

\457.

\458.

\459.

\460.

\461.

\462.

\463.

%from the paper)

result{2,1} = sol\_rmse\_fitted; %Error

result{2,2} = b0(1);

result{2,3} = x(1);

result{2,4} = b0(2);

result{2,5} = x(2);

result{2,6} = b0(3);

result{2,7} = x(3);

result{2,8} = b0(4);

result{2,9} = x(4);

result{2,10} = b0(5);

result{2,11} = x(5);

result{2,12} = b0(6);

result{2,13} = x(6);

result{2,14} = conc\_fitted(:,4); %V values

%%

%%

%Plotting the graph for Case 1

figure

xa=log10(conc\_paper(:,4));

xa(xa<-2)=-2;

plot(time,xa,'r-')

hold on

xx=log10(conc\_fitted(:,4));

xx(xx<-2)=-2;

xy=log10(v\_actua);

xy(xy<-2)=-2;

plot(time,xx,'b-')

hold on

plot(time,xy,'g\*')

title('Fitting for Case 1')

subtitle(subtit)

xlabel('Time(Days)')

ylabel('log10 copies per ml')

legend('Using paper value','Fitted','Actual')

hold off

grid

34





\464.

\465.

\466.

\467.

\468.

\469.

\470.

\471.

\472.

\473.

\474.

\475.

\476.

\477.

\478.

\479.

\480.

\481.

\482.

\483.

\484.

\485.

\486.

\487.

%%

%% Generating random Variables for the initial guesses

%bet= 10^(-8)+(0.0001-10^(-8)).\*rand(1,60);

% sigm= 0+(0.5-0).\*rand(1,60);

% me= randi([6 15],1,60); %We can only have integer values here

% omeg= 10^(-5)+(0.01-10^(-5)).\*rand(1,60);

% pp= 10+(10^5-10).\*rand(1,60);

% cc= 0.5+(300-0.5).\*rand(1,60);

%

% rands=[ bet; sigm; me; omeg; pp; cc;];

%%

%% Fitting for different Initial Guesses ( Plots given at the end)

for r=1:60

b0=rands(:,r);

z=r+2;

i= sprintf('Initial Values for Case %d :-',r+1);

disp(i);

X0 = sprintf('Beta: %d \nSigma: %d \nMeu: %d \nOmega: %d \np: %d

\nc: %d\n\n',b0(1),b0(2),b0(3),b0(4),b0(5),b0(6));

\488.

disp(X0);

\489.

\490.

[x,sol\_rmse\_fitted] =

fmincon(@(x)fitness\_function(x,y0,[0;t\_actual],v\_actual),b0,[],[],[],[],[1

0^(-8);0;6;10^(-

5);10;0.5],[0.0001;0.5;15;0.01;10^5;300],@(x)constraints(x,limit,[0;t\_actu

al],y0,v\_actual),options);

\491.

\492.

[time, conc\_fitted] = ode45(@(t,y) model(t,y,x),[0;t\_actual],y0);

% We need it for the plot function

\493.

\494.

\495.

\496.

f= sprintf('Final Values for Case %d :-',r+1);

disp(f);

X1 = sprintf('Beta: %d \nSigma: %d \nMeu: %d \nOmega: %d \np: %d

\nc: %d\n\n',x(1),x(2),x(3),x(4),x(5),x(6));

\497.

disp(X1);

\498.

\499.

\500.

\501.

\502.

\503.

\504.

\505.

\506.

\507.

\508.

\509.

\510.

err= sprintf('Error for Case %d = %d \n\n',r+1,sol\_rmse\_fitted);

disp(err);

%Storing the data obtained

result{z,1} = sol\_rmse\_fitted;

result{z,2} = b0(1);

result{z,3} = x(1);

result{z,4} = b0(2);

result{z,5} = x(2);

result{z,6} = b0(3);

result{z,7} = x(3);

result{z,8} = b0(4);

35





\511.

\512.

\513.

\514.

\515.

\516.

\517.

\518.

\519.

\520.

\521.

\522.

\523.

\524.

\525.

\526.

\527.

\528.

\529.

\530.

\531.

\532.

\533.

\534.

\535.

\536.

\537.

\538.

\539.

\540.

\541.

\542.

\543.

\544.

\545.

\546.

\547.

\548.

result{z,9} = x(4);

result{z,10} = b0(5);

result{z,11} = x(5);

result{z,12} = b0(6);

result{z,13} = x(6);

result{z,14} = conc\_fitted(:,4);

t= sprintf('Fitting for Case %d',r+1);

%%

% Plots for each case

figure

xa=log10(conc\_paper(:,4));

xa(xa<-2)=-2;

plot(time,xa,'r-')

hold on

xx=log10(conc\_fitted(:,4));

xx(xx<-2)=-2;

xy=log10(v\_actua);

xy(xy<-2)=-2;

plot(time,xx,'b-')

hold on

plot(time,xy,'g\*')

title(t)

subtitle(subtit)

xlabel('Time(Days)')

ylabel('log10 copies per ml')

legend('Using paper value','Fitted','Actual')

hold off

grid

end

%%

36





**Appendix E: Viral Dynamics Under Treatment**

**CODE FOR VIRAL DYNAMICS UNDER TREATMENT**

**Original Model Function**

1.function dy = model(t,y,b)

2.%% This is the function that is used in ode45

\3.

4.% b(1) : beta

5.% b(2) : sigma

6.% b(3) : meu

7.% b(4) : omega

8.% b(5) : p

9.% b(6) : c

\10.

\11.

\12.

\13.

\14.

\15.

\16.

\17.

dy(1) = -b(1)\*y(4)\*y(1); % T1

dy(2) = 10^4 - b(1)\*y(4)\*y(2); % T2

% This is the part euivalent to die.m

if(t >= b(3))

dy(3) = b(1)\*y(4)\*(y(1) + y(2)) - (2\*exp(b(2)\*(t-b(3))) +

b(4)\*y(2))\*y(3); % I

\18.

\19.

\20.

\21.

\22.

\23.

\24.

\25.

\26.

\27.

\28.

else

dy(3) = b(1)\*y(4)\*(y(1) + y(2)) - (2 + b(4)\*y(2))\*y(3); % I

end

%

dy(4) = b(5)\*y(3) - b(6)\*y(4); % V

dy = dy';

end

**Modified Model Function :-**

1.function dy = model\_with\_drug(t,y,b,e,day,N)

2.%% This is the function that is used in ode45

\3.

\4.

\5.

6.% e is the efficacy to eliminate the virus

7.% N represents the efficacy of the drug to block the infection ( Prevent

T1 from

8.% becoming V)

\9.

\10.

\11.

\12.

% b(1) : beta

% b(2) : sigma

% b(3) : meu

37





\13.

\14.

\15.

\16.

\17.

\18.

\19.

\20.

\21.

\22.

\23.

\24.

\25.

% b(4) : omega

% b(5) : p

% b(6) : c

if( t<day)

dy(1) = -b(1)\*y(4)\*y(1); % T1

dy(2) = 10^4 - b(1)\*y(4)\*y(2); % T2

% This is the part euivalent to die.m

if(t >= b(3))

dy(3) = b(1)\*y(4)\*((y(1)) + y(2)) - (2\*exp(b(2)\*(t-b(3))) +

b(4)\*y(2))\*y(3); % I

\26.

\27.

\28.

\29.

\30.

\31.

\32.

\33.

\34.

\35.

\36.

\37.

\38.

\39.

\40.

else

dy(3) = b(1)\*y(4)\*((y(1)) + y(2)) - (2 + b(4)\*y(2))\*y(3); % I

end

%

dy(4) = b(5)\*y(3) - b(6)\*y(4); % V

else

dy(1) = -b(1)\*y(4)\*y(1)\*(1-N); % T1

dy(2) = 10^4 - b(1)\*y(4)\*y(2); % T2

if(t >= b(3))

dy(3) = b(1)\*y(4)\*((y(1)) + y(2)) - (2\*exp(b(2)\*(t-b(3))) +

b(4)\*y(2))\*y(3); % I

\41.

\42.

\43.

\44.

\45.

\46.

\47.

\48.

\49.

\50.

\51.

\52.

\53.

\54.

else

dy(3) = b(1)\*y(4)\*((y(1)) + y(2)) - (2 + b(4)\*y(2))\*y(3); % I

end

dy(4) = (1-e)\*b(5)\*y(3) - b(6)\*y(4);

end

dy = dy';

end

38





**Main :-**

1.clc;

2.clear;

\3.

4.s='Patient 10 : Case 46';

\5.

6.efficacy=[0.50 0.95];

\7.

8.%Different efficacies of antiviral drug

9.drugs=[0.25 0.5 0.75 0.9];

\10.

\11.

\12.

\13.

\14.

\15.

\16.

\17.

\18.

\19.

\20.

\21.

\22.

\23.

\24.

\25.

\26.

\27.

\28.

\29.

\30.

\31.

\32.

\33.

\34.

\35.

\36.

\37.

\38.

\39.

\40.

\41.

\42.

\43.

\44.

\45.

\46.

\47.

\48.

\49.

\50.

\51.

e=0.25;

%Days on which the treatment was started

days=[10 15 20];

%%

%%

%Parameter Values for the patient

beta = 0.0000187 ;

p = 19134.96455;

c = 35.65844795;

omega = 0.01;

sigma = 0.268531406;

meu = 12;

%Vector storing the parameter values

b(1) = beta;

b(2) = sigma;

b(3) = meu;

b(4) = omega;

b(5) = p;

b(6) = c;

%%

%% Initial Conditions

T1 = 60000;

T2 = 0;

I = 0;

V = 0.0001;

y0 = [T1;T2;I;V]; % Storing Initial Conditions

%%

%% Solving system of ODEs using ode45

t\_start = 0;

t\_end = 30;

t\_span = [t\_start:t\_end];

%Running the loop for different efficacies

39





\52.

\53.

\54.

\55.

\56.

\57.

\58.

\59.

\60.

\61.

\62.

\63.

\64.

\65.

\66.

\67.

\68.

\69.

\70.

for j=1:length(drugs)

N=drugs(j); %Efficacy

%Without Treatment

[time, vir] = ode45(@(t,y) model(t,y,b),t\_span,y0);

figure

xa=log10(vir(:,4));

xa(xa<0)=0;

plot(time,xa)

hold on

%%

%%

%Running the loop for different days on which the treatment was

started

\71.

\72.

\73.

\74.

\75.

for i=1:3

day=days(i); %different days on which the treatment was started

%with Treatment

[time, vir\_d] = ode45(@(t,y)

model\_with\_drug(t,y,b,e,day,N),t\_span,y0);

\76.

\77.

\78.

\79.

\80.

\81.

\82.

\83.

\84.

\85.

\86.

\87.

\88.

\89.

\90.

\91.

\92.

\93.

\94.

\95.

\96.

\97.

\98.

\99.

\100.

\101.

xx=log10(vir\_d(:,4));

xx(xx<0)=0;

plot(time,xx)

hold on

end

%%

%%

t= sprintf('For e=%f and N=%f',e,N);

title(t)

subtitle(s)

xlabel('Time(Days)')

ylabel('log10 copies per ml')

legend('No Treatment ','10th Day','15th Day','20th Day')

hold off

grid

end

40

